---
title: "paper2_resistance_mechanisms_mixtures"
output: pdf_document
#output: word_document
author: "Andy South, Ian Hastings and Bethany Levick"
date: "`r Sys.Date()`"
---

```{r,echo=FALSE,results='hide'}
  library(resistance)
  library(ggplot2)
```

### version 3
 
# Mechanisms by which insecticide resistance can be influenced by strategies of insectcide use : a simple theoretical exploration. 
  
(This file is automagically generated by R from paper2_resistance_mechanisms_mixtures.Rmd)
Target : Malaria journal

#### TO DO
1. decide whether to use selective advantage or rr restoration coefficient


## Abstract

This paper explores the mechanisms by which insectide resistance is expected to increase with the use of insecticides in isolation, sequence/rotation and mixtures. It is aimed at a readership with limited experience of population genetics and resistance. It uses a model representing two independent loci coding for resistance to two insecticides. It explores factors that are expected to influence the development of resitance, notably the starting frequency of resistance alleles, their dominance, the exposure of insects to the insecticides, the effectiveness of the insecticides, the selective advantage of resistance and the dominance of the alleles. There is uncertainty about the values of these parameters in field situations. We demonstrate how the values of these parameters are expected to influence the development of resistance and the relative benefits of alternative insecticide application strategies. We describe an R package and user-interface that allows further exploration of the development of resistance. The user-interface (https://andysouth.shinyapps.io/MixSeqResist1) allows replication of our results and exploration of what happens when inputs are changed outside of the ranges we have used. 

## Introduction

Insecticide resistance is a problem for malaria (GPIRM), other vector borne diseases and agriculture.

Insecticide resistance becomes a problem when genes coding for resistance firstly arise in a population and secondly increase in frequency. We concern ourselves with this second process of how insecticide resistance increases in frequency within a population.

The changing frequency of insecticide resistance is a population genetic process that can be influenced by the parameters outlined in Table 1.

**Table 1. Parameters inflencing the development of insecticide resistance**

Parameter  | Description
------------------- | -------------------------------------------------------
1. Effectiveness | proportion of exposed insects with the susceptible allele that are killed by the insecticide
2. Exposure | proportion of the insect population that are exposed to the insecticide
3. Dominance | dominance of the resistance allele relative to the susceptible allele
4. Resistance restoration  | ability of resistance to restore fitness in the presence of the insecticide
5. Frequency  | frequency of resistance alleles within the population


We use a 2-locus population genetic model of insecticide resistance (Hastings et al. in press) to illustrate the mechanisms by which these parameters are expected to influence the development of insectide resistance under alternative insecticide use strategies. Hastings et al. (in press) describe the technical details of the model and explore large parameter ranges. In contrast we provide an accessible summary of the model and use selected parameter values to demonstrate mechanisms that can influence the development of resistance. 


## Methods

*accessible summary of the model* 



## Results

For single insecticide use, faster resistance resulted from higher values of any of the inputs outlined in Table 1, namely effectiveness, exposure, dominance, the resistance restoration coefficient, and starting frequencies of resistance (Figs 1-3). In these plots each input was varied in isolation with the others set at a constant 0.5, or 0.01 for starting frequency of resistance.


When two insecticides are used the relative performance of a mixture strategy compared to sequential use is determined by the values of these inputs. To help us understand the mechanisms influencing this relative performance we started with a single base scenario and investigated changing inputs indivividually. For our base scenario we set the values for the first four inputs in Table 1 to 0.5 and the starting frequencies of resistance to 0.1. For this base scenario resistance arises slower for sequential than mixture (Fig 4A). This plot, and those that follow, compares mixture and sequence for a single input scenario (where the previous plots showed 3 input scenarios). Resistance to both insecticides in the mixture follow the same path and reach the threshold at the same time. When used in sequence the curve (dashed) for each insecticide individually is steeper but, because they happen one after the other, it takes longer to reach the resistance threshold for both.


### Insecticide effectiveness
A more effective insecticide prompts increased time-to-resistance when used in a mixture. This contrasts with the earlier result showing that when used in isolation a single insecticide prompts a shorter time-to-resistance.

For example taking the base scenario and increasing the effectiveness of one insecticide from 0.5 to 0.8 increases the time-to-resistance for the mixture and decreases that for the sequence (Fig 4B). In the mixture resistance to insecticide1 (with the increased effectiveness) rises at a similar speed to the base scenario (Fig 4A). 

When the effectiveness of both insecticides are increased to 0.8 the time-to-resistance is increased still further to around 125 generations (Fig 5). In this case the curves for the rise in resistance to each insecticide are identical. The curves are shallower than previous plots because individuals that are resistant to each insecticide are being killed by the other thus reducing the increase in resistance alleles. As the resistance frequencies go above 10% around generation 100 both insecticides provide less protection to the other and the slope of the resistance curve increases.  


### Exposure
Increasing exposure to 0.8 reduces time-to-resistance for both mixture and sequential scenarios (Fig 6A relative to 4A). The change in exposure has a greater effect on the mixture relative to the sequential strategy and this results in a greater relative benefit for sequence versus mixture. Remembering that earlier increasing one effectiveness to 0.8 resulted in mixtures being favoured over sequence (Fig 4B). Increasing exposure from 0.5 to 0.8 switches back to sequential being the favoured strategy (Fig 6B). This demonstrates how higher exposures can favour sequential use.


### Dominance of resistance alleles
Increasing the dominance of the alleles within a mixture has the same direction of effect as it does for sole use. Increasing the dominance of the allele corresponding to insecticide1 from 0.5 to 0.8 decreases the time-to-resistance to insecticide1 within the mixture but leaves the time-to-resistance for the second insecticide in the mixture the same (Fig 7A). Setting the dominance for both alleles to 0.8 reduces the time-to-resistance for both the mixture and the sequence by 20 generations from the base scenario (compare Fig 7B to 4A). In both of these cases sequential use continues to have a longer time-to-resistance under the higher dominance.


### Resistance restoration coefficient
Increasing the resistance restoration coefficient to insecticide1 from 0.5 to 0.8 decreases the time-to-resistance for insecticide1 in the mixture, and has a similar effect on it's use in the sequence (Fig 8A). However, it has little effect on resistance to insecticide2. Because of this sequential use continues to generate a longer time-to-resistance than the mixture. Increasing the resistance restoration coefficient of both alleles to 0.8 results in a shorter time-to-resistance  for the mixture (Fig 8B), however the relative shape of the resistance curves remains similar to the base scenario  (Fig 4A), with sequential use continuing to generate longer time-to-resistance.  

### Starting frequencies of resistance
Changing the starting frequency of resistance had a similar effect on time to resistance for both sequences and mixtures and thus had little effect on their relative performance. For example taking the base scenario and reducing the starting frequency of one resistance allele did not change from sequence being favoured (compare Fig 9A to Fig 4A). Similarly taking the base scenario with effectiveness of the first insecticide increased to 0.8 (Fig 4B) and decreasing starting frequency of that resistance allele did not result in the mixture being favoured (Fig 9B). 


## Discussion

Higher values of all of the inputs lead to faster resistance when the insecticide was used singly. This can be explained by different mechanisms (see Table 2 for summary). [write more about this here]


[explain the effectivenes result, referring to Fig 4B versus 4A]
In contrast, resistance to insecticide2 increases more slowly initially. Once insecticide1 reaches it's resistance threshold, the curve for insecticide2 becomes steeper. This can be explained by the mechanism that once insecticide1 has become ineffective due to resistance it stops killing indivduals that are resistant to insecticide2 and thus stops 'protecting' it from it's own rise in resistance.


[Summary tables to refer to from discussion.]

**Table 2. Effect of inputs on resistance when insecticides used singly or in sequence**

Parameter to increase  | effect on resistance | Mechanism
------------------ | ------- | ---------------------------------------------------
1. Effectiveness | faster | increased deaths of susceptibles
2. Exposure | faster | increased deaths of susceptibles
3. Dominance | faster | increased survival of heterozygotes
4. Resistance restoration | faster | increased survival of resistants
5. Frequency  | faster | less change needed to reach resistance threshold

**Table 3. Effect of inputs on resistance when insecticides used in a mixture**

Parameter to increase  | effect on resistance | Mechanism
------------------ | --------- | ---------------------------------------------------
1. Effectiveness | **slower** | increased deaths of individuals resistant to the other insecticide
2. Exposure | faster (but less than for single) | increased deaths of individuals susceptible to one insecticide increases selection pressure for that resistance. However at the same time selection pressure is reduced by higher deaths of resistant individuals caused by the other insecticide.
3. Dominance | faster | increased survival of resistants
4. Resistance restoration | faster | increased survival of resistants
5. Frequency  | faster | less change needed to reach resistance threshold

**Table 4. Effect of inputs on the difference between mixture and sequential use**

Parameter to increase  | increase favours mix or sequence | Mechanism
------------------ | ------- | ---------------------------------------------------
1. Effectiveness | mixture | Higher effectiveness gives faster resistance for sequence and slower resistance in mixture
2. Exposure | sequence | Higher exposure gives faster resistance for sequence and mixture but the greater effect on mixture favours sequence.
3. Dominance | neither | Higher dominance gives faster resistance in both sequences and mixtures such that the difference between them is not changed. 
4. Resistance restoration | neither | As for dominance. Higher resistance restoration gives faster resistance in both sequences and mixtures such that the difference between them is not changed.
5. Frequency  | neither | As for dominance and resistance restoration. Higher starting frequencies give faster resistance in both sequences and mixtures such that the difference between them is not changed.



(@) In a mixture each insecticide reduces the rate of increase in resistance to the other by killing individuals that are resistant to the other.

(@) In a mixture the effectiveness of one insecticide has major effects on the resistance of the other. In contrast the dominance and selective advantage of one insecticide has less effect on the resistance of the other. For exposure we have kept values the same for each insecticide the same (to represent a mixture in which the 2 insecticides are applied together). However we predict that if they were applied separately then (similar to effectiveness) the level of exposure to one insecticide would influence the time-to-resistance of the other. 

(@) In a mixture higher effectiveness of either insecticide kills more individuals resistant to the other and thus increases time-to-resistance for the other. Thus although increasing effectiveness of an insecticide decreases time-to-resistance when used alone, when used in a mixture time-to-resistance for both insecticides is increased.

(@) For a mixture of 2 insecticides with differing effectiveness. Resistance to the insecticide with a greater effectiveness increases faster. The less effective insecticide is 'protected' by the more effective. Resistance to the less effective insecticide increases slowly until resistance to the more effective insecticide reaches a high level at which point it starts to increase faster.

(@) Increasing exposure gives shorter time-to-resistance for both mixtures and sequences due to increased deaths of susceptibles creating a higher selection pressure. In a mixture the effect of exposure is greater and this means that increasing exposure can make sequences preferable to mixtures. The reason for the greater effect of exposure on mixtures could be that exposure is having both a direct effect on each insecticide and an indirect effect on the other. Thus higher exposures lead to faster resistance in each insecticide (direct), in turn increased resistance to each insecticide reduces the 'protection' that it gives the other, leading to faster resistance in the other (indirect). This could act as a postive feedback loop where faster resistance in one contributes to faster resistance in the other.   







## References
1. GPIRM
1. Curtis 
1. Mani GS. Evolution of resistance in the presence of two insecticides. Genetics 1985;109(4):761â€“83.
1. Birget 2015
1. Curtis et al 1993, potential IRM strategies :
~ moderation : preserve susceptible genes by limiting selection pressure
~ saturation : high dose so that heterozygous resistants are killed
~ multiple attack : independently acting pressures neither of which is strong enough to lead to resistance




## Todo

1. work out what's going on with exposure ... why does increasing exposure have a greater effect on mixture than sequential ? Is it because the exposure to one insecticide also effects the development of resistance in the other ?
1. In discussion and maybe elewhere address potential concern that the relationships shown here may not hold for all of paramter space.
1. re-read GPIRM
1. can I develop explanatory diagrams to describe the input parameters ?
1. mention generation time of 1 month
1. mention other potential effects e.g. differential exposure of M&F, sex linkage, ...



```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3, fig.show='hold', fig.align='left', fig.cap="Effect of inputs on single insecticide use. A. Effectiveness, B. Exposure"}

  a <- setExposure(exposure=0.5, insecticideUsed='insecticide1')

  i1 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.2,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i2 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i3 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.8,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )
  
  #input <- cbind(input, inputOneScenario)
  input <- cbind(i1,i2,i3)
  
  listOut <- runModel2( input )
  
  df_resist <- get_resistance(locus=1, listOut)

    
  print( ggplot(df_resist, aes(x=generation, y=resistance, colour=factor(phi.SS1_A0))) + 
         theme_bw() +  
         theme(legend.position = "bottom", legend.key = element_blank()) + 
         guides(colour = guide_legend(reverse=TRUE)) +  
         labs(colour = "effectiveness") +
         coord_trans(y = "log10") +    
         geom_line()   
         
       ) 
  


  exposure <- 0.2
  a <- setExposure(exposure = exposure, insecticideUsed='insecticide1')

  i1 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      exposure = exposure, #used for post-run analysis
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )
 
  exposure <- 0.5
  a <- setExposure(exposure = exposure, insecticideUsed='insecticide1')   

  i2 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      exposure = exposure, #used for post-run analysis
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  exposure <- 0.8
  a <- setExposure(exposure = exposure, insecticideUsed='insecticide1')  
  
  i3 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      exposure = exposure, #used for post-run analysis
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )
  
  input <- cbind(i1,i2,i3)
  
  listOut <- runModel2( input )
  
  df_resist <- get_resistance(locus=1, listOut)

    
  print( ggplot(df_resist, aes(x=generation, y=resistance, colour=factor(exposure))) + 
         theme_bw() +
         theme(legend.position = "bottom", legend.key = element_blank()) + 
         guides(colour = guide_legend(reverse=TRUE)) +
         labs(colour = "exposure", y=NULL) +
         coord_trans(y = "log10") +   
         geom_line()   
         
       )
  
```


```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3, fig.show='hold', fig.align='left', fig.cap="Effect of inputs on single insecticide use. A. Dominance, B. Resistance restoration"}

  #single insecticide dominance fig

  a <- setExposure(exposure=0.5, insecticideUsed='insecticide1')

  i1 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.2, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i2 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i3 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.8, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )
  
  input <- cbind(i1,i2,i3)
  
  listOut <- runModel2( input )
  
  df_resist <- get_resistance(locus=1, listOut)

    
  print( ggplot(df_resist, aes(x=generation, y=resistance, colour=factor(h.RS1_A0))) + 
         theme_bw() +
         theme(legend.position = "bottom", legend.key = element_blank()) + 
         guides(colour = guide_legend(reverse=TRUE)) + 
         labs(colour = "dominance") +
         coord_trans(y = "log10") + 
         geom_line()   
         
       )
  
  # single insecticide resistance restoration fig.
  
  a <- setExposure(exposure=0.5, insecticideUsed='insecticide1')

  i1 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.2,
                      rr_restoration_ins2 = 0.5 )

  i2 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i3 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.8,
                      rr_restoration_ins2 = 0.5 )
  
  input <- cbind(i1,i2,i3)
  
  listOut <- runModel2( input )
  
  df_resist <- get_resistance(locus=1, listOut)

    
  print( ggplot(df_resist, aes(x=generation, y=resistance, colour=factor(rr_restoration_ins1))) + 
         theme_bw() +
         theme(legend.position = "bottom", legend.key = element_blank()) + 
         guides(colour = guide_legend(reverse=TRUE)) +
         labs(colour = "rr restoration", y=NULL) +
         coord_trans(y = "log10") +   
         geom_line()   
       )
  
```

```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3, fig.show='hold', fig.align='left', fig.cap="Effect of resistance starting frequency on single insecticide use."}

  #single insecticide frequency fig

  a <- setExposure(exposure=0.5, insecticideUsed='insecticide1')

  i1 <- setInputOneScenario( max_gen = 500,
                      P_1 = 0.001,       
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i2 <- setInputOneScenario( max_gen = 500,
                      P_1 = 0.01,       
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i3 <- setInputOneScenario( max_gen = 500,
                      P_1 = 0.1,       
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )
  
  input <- cbind(i1,i2,i3)
  
  listOut <- runModel2( input )
  
  df_resist <- get_resistance(locus=1, listOut)

  print( ggplot(df_resist, aes(x=generation, y=resistance, colour=factor(P_1))) + 
         theme_bw() +
         theme(legend.position = "bottom", legend.key = element_blank()) + 
         guides(colour = guide_legend(reverse=TRUE)) + 
         labs(colour = "start\nfrequency") +
         coord_trans(y = "log10") + 
         geom_line()   
         
       )
```


```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3.7, fig.show='hold', fig.align='left', fig.cap="A. All control inputs equal at 0.5, B. Effectiveness of insecticide1 increased from 0.5 to 0.8"}
#effectiveness on mixture

#plot margins
oldpar <- par(mar=c(4, 4, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), addLegend=FALSE, main='A.' )

#plot margins
par(mar=c(4, 0, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.8 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), ylab="", main='B.' )

par(oldpar)

```

```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3.7, fig.show='hold', fig.align='left', fig.cap="Effectiveness of both insecticides 0.8"}

#plot margins
oldpar <- par(mar=c(4, 4, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.8 , phi.SS2_0B = 0.8 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2') )

```

```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3.7, fig.show='hold', fig.align='left', fig.cap="A. Exposure increased to 0.8, B. Exposure and Effectiveness of insecticide1 increased from 0.5 to 0.8"}
#fig.cap seems necessary to keep figs side by side

#plot margins
oldpar <- par(mar=c(4, 4, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)


runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.8 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), addLegend=FALSE, main='A.' )
#cat("Fig. Exposure 0.8 benefit of sequence over mixture increases")

#plot margins
par(mar=c(4, 0, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.8 , phi.SS1_A0 = 0.8 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), main='B.' )
#cat("Fig. Effectiveness 0.8, Exposure 0.8, increased exposure nullifies the effect of increased effectiveness, sequence remains better")
```

```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3.7, fig.show='hold', fig.align='left', fig.cap="A. Dominance of insecticide1 0.8, B. Dominance of both insecticides 0.8"}

#plot margins
oldpar <- par(mar=c(4, 4, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.8 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), addLegend=FALSE, main='A.' )
#cat("Dominance of insecticide1 0.8")

#plot margins
par(mar=c(4, 0, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.8 , h.RS2_0B = 0.8 , exposure = 0.5 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), ylab='', main='B.' )
#cat("Dominance of both insecticides 0.8")

par(oldpar)

```


```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3.7, fig.show='hold', fig.align='left', fig.cap="A. Resistance restoration coefficient allele1 0.8, B. Resistance restoration coefficient both alleles 0.8"}

#plot margins
oldpar <- par(mar=c(4, 4, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.8 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), addLegend=FALSE, main='A.' )
#cat("Fig. rr_restoration I1 0.8")

#plot margins
par(mar=c(4, 0, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.8 , rr_restoration_ins2 = 0.8 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), ylab='', main='B.' )
#cat("Fig. CC. rr_restoration I2 0.2")

par(oldpar)

```

```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3.7, fig.show='hold', fig.align='left', fig.cap="A. Start frequency allele1 reduced from 0.001, B. as A plus effectiveness insecticide1 increased to 0.8"}

#plot margins
oldpar <- par(mar=c(4, 4, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

#P_1 to 0.001 seq remains better
runcurtis_f2( max_gen=500,  P_1 = 0.001 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), addLegend=FALSE, main='A.' )

#plot margins
par(mar=c(4, 0, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

#P_1 to 0.001 & effect1 to 0.8 mix remains better
runcurtis_f2( max_gen=500,  P_1 = 0.001 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.8 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), ylab='', main='B.' )

par(oldpar)

```





